// Generated by CoffeeScript 1.10.0
(function() {
  var Crypto, Method, base64, base64url, isBuffer, isString, md5, ref;

  Crypto = require("crypto");

  Method = require("fairmont-multimethods").Method;

  ref = require("./type"), isBuffer = ref.isBuffer, isString = ref.isString;

  md5 = Method.create();

  Method.define(md5, isString, function(string) {
    return Crypto.createHash('md5').update(string, 'utf-8').digest("hex");
  });

  Method.define(md5, isBuffer, function(buffer) {
    return Crypto.createHash('md5').update(buffer, 'binary').digest("hex");
  });

  base64 = function(string) {
    return new Buffer(string).toString('base64').replace(/\=+$/, '');
  };

  base64url = function(string) {
    return new Buffer(string).toString('base64').replace(/\+/g, '-').replace(/\//g, '_').replace(/\=+$/, '');
  };

  module.exports = {
    md5: md5,
    base64: base64,
    base64url: base64url
  };

}).call(this);
